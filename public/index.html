
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>registrarse</title>
    <link rel="stylesheet" href="css/sing-up/s-main-general.css">
</head>
<body>
    <!-- Registro de usuario -->
        <button onclick="autenticaradmin()" class="btn_admin">游녻</button>
    <dialog class="dialog_autentic" id="dialog">
            <section class="section">
                <h1 class="title-main">Crea tu Perfil</h1>
            </section>
            <section class="section">
                <div>
                    <input type="email" id="email" name="email" required placeholder="Correo">
                </div>
            </section>
            <section class="section">
                <div>
                    <input type="password" id="password" name="password" autocomplete="password" required placeholder="contrase침a">
                </div>
            </section>
            <section class="section">
                <div class="boton-siguiente">
                    <button onclick="Enviar()">Enviar</button>
                    <button onclick="Cerrar()">Cerrar</button>
                </div>
            </section>
        </dialog>
    <main>
        
        
        <!-- Formulario del usuario...........-->
        <div class="register">
            <section class="section">
                <h1 class="title-main">Crea tu Perfil</h1>
            </section>
            <section class="section">
                <div>
                    <label>Escriba su nombre</label>
                    <input type="text" id="nombre" name="text" required placeholder="escriba su nombre y apellido">
                </div>

            </section>
            <section class="section">
                <div>
                    <label>Escriba su telefono</label>
                <input type="tel" id="telefono" name="telefono" autocomplete="tel" required placeholder="example: 9999-9999">
                </div>
                
            </section>
            <section class="section">
                <div class="boton-siguiente">
                    <button onclick="acceder()">Siguiente</button>
                    <div class="div-chk">
                        <p><input type="checkbox" class="input-chk" id="termino-chk">Revice nuestros <a href="terminos.html">T칠rminos y Condiciones</a></p>
                    </div>
                </div>
            </section>
        </div>
    </main>
    <script src="js/sing-up-js/script.js"></script>
    <!-- Dentro de tu index.html -->
     <script type="module">
        // Importar desde CDN de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"; // <--- IMPORTA ESTO NUEVO
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Configuraci칩n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCZ0XEcKUKtbB7WiUAmaIbBf-UkqTgZYxY",
            authDomain: "apartados-sagar-1a901.firebaseapp.com",
            projectId: "apartados-sagar-1a901",
            storageBucket: "apartados-sagar-1a901.firebasestorage.app",
            messagingSenderId: "145902728046",
            appId: "1:145902728046:web:4468fb60b5d72cd4efc77f",
            measurementId: "G-ESJ7EXWH7Z"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);


        // Funci칩n de login (ahora S칈 est치 disponible globalmente)
        window.Enviar = function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                alert('Completa todos los campos');
                return;
            }
            
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    
                    // Lista de admins
                    const ADMINS = [
                        'admin@apartadossagar.com',
                    ];
                    
                    // Verificar si es admin
                    if (ADMINS.includes(user.email)) {
                        alert('Bienvenido Admin');
                        window.location.href = '/inicio.html';
                    } else {
                        alert('Bienvenido Usuario');
                        window.location.href = '/inicio.html';
                    }
                })
                .catch((error) => {
                    console.error('Error:', error);
                    
                    // Mensajes de error en espa침ol
                    if (error.code === 'auth/invalid-credential') {
                        alert('Email o contrase침a incorrectos');
                    } else if (error.code === 'auth/user-not-found') {
                        alert('Usuario no encontrado');
                    } else if (error.code === 'auth/wrong-password') {
                        alert('Contrase침a incorrecta');
                    } else if (error.code === 'auth/too-many-requests') {
                        alert('Demasiados intentos. Espera un momento.');
                    } else {
                        alert('Error: ' + error.message);
                    }
                });
        }
        setPersistence(auth, browserLocalPersistence)
        .then(() => {
            console.log("Persistencia activada. El usuario quedar치 logueado.");
        })
        .catch((error) => {
            console.error("Error al configurar persistencia:", error);
        });
    </script>
</body>
</html>